{"version":3,"file":"delta-force.js","sources":["../index.es"],"sourcesContent":["import bipolar from 'bipolar';\n\nconst deltaForce = (() => {\n  const on = document.addEventListener;\n  const off = document.removeEventListener;\n\n  // -1: idle, 0: left, 1: middle, 2: right\n  let state = -1;\n  let delta = [0, 0, 0];\n  let force = bipolar();\n\n  const mouseMove = (e) => {\n    delta = force(e.clientX, e.clientY, 0);\n  };\n\n  const mouseUp = () => {\n    state = -1;\n\n    off('mouseup', mouseUp);\n    off('mousemove', mouseMove);\n  };\n\n  on('mousedown', (e) => {\n    state = e.button;\n    force = bipolar(e.clientX, e.clientY, 0);\n\n    on('mouseup', mouseUp);\n    on('mousemove', mouseMove);\n  });\n\n  const handleTouch = (e, fn) => {\n    const x = e.touches[0].pageX;\n    const y = e.touches[0].pageY;\n\n    let distance = 0;\n\n    if (state === 1) {\n      const dx = x - e.touches[1].pageX;\n      const dy = y - e.touches[1].pageY;\n\n      distance = Math.sqrt((dx * dx) + (dy * dy));\n    }\n\n    return fn(x, y, distance);\n  };\n\n  on('touchstart', (e) => {\n    state = e.touches.length - 1;\n    force = handleTouch(e, bipolar);\n  });\n\n  on('touchmove', (e) => {\n    // Can't rely on viewport meta tag no more\n    // https://twitter.com/thomasfuchs/status/742531231007559680\n    e.preventDefault();\n\n    delta = handleTouch(e, force);\n  });\n\n  on('touchend', () => {\n    state = -1;\n  });\n\n  on('wheel', (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    state = 1;\n    delta = [0, 0, e.deltaY];\n  });\n\n  return () => {\n    const x = delta[0];\n    const y = delta[1];\n    const z = delta[2];\n\n    // Reset\n    delta = [0, 0, 0];\n\n    return { x, y, z, state };\n  };\n})();\n\nexport default deltaForce;\n\n"],"names":["deltaForce","on","document","addEventListener","off","removeEventListener","state","delta","force","bipolar","mouseMove","e","clientX","clientY","mouseUp","button","handleTouch","fn","x","touches","pageX","y","pageY","distance","dx","dy","Math","sqrt","length","preventDefault","stopPropagation","deltaY","z"],"mappings":";;;AAEA,IAAMA,aAAc,YAAM;MAClBC,KAAKC,SAASC,gBAApB;MACMC,MAAMF,SAASG,mBAArB;;;MAGIC,QAAQ,CAAC,CAAb;MACIC,QAAQ,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAZ;MACIC,QAAQC,SAAZ;;MAEMC,YAAY,SAAZA,SAAY,CAACC,CAAD,EAAO;YACfH,MAAMG,EAAEC,OAAR,EAAiBD,EAAEE,OAAnB,EAA4B,CAA5B,CAAR;GADF;;MAIMC,UAAU,SAAVA,OAAU,GAAM;YACZ,CAAC,CAAT;;QAEI,SAAJ,EAAeA,OAAf;QACI,WAAJ,EAAiBJ,SAAjB;GAJF;;KAOG,WAAH,EAAgB,UAACC,CAAD,EAAO;YACbA,EAAEI,MAAV;YACQN,QAAQE,EAAEC,OAAV,EAAmBD,EAAEE,OAArB,EAA8B,CAA9B,CAAR;;OAEG,SAAH,EAAcC,OAAd;OACG,WAAH,EAAgBJ,SAAhB;GALF;;MAQMM,cAAc,SAAdA,WAAc,CAACL,CAAD,EAAIM,EAAJ,EAAW;QACvBC,IAAIP,EAAEQ,OAAF,CAAU,CAAV,EAAaC,KAAvB;QACMC,IAAIV,EAAEQ,OAAF,CAAU,CAAV,EAAaG,KAAvB;;QAEIC,WAAW,CAAf;;QAEIjB,UAAU,CAAd,EAAiB;UACTkB,KAAKN,IAAIP,EAAEQ,OAAF,CAAU,CAAV,EAAaC,KAA5B;UACMK,KAAKJ,IAAIV,EAAEQ,OAAF,CAAU,CAAV,EAAaG,KAA5B;;iBAEWI,KAAKC,IAAL,CAAWH,KAAKA,EAAN,GAAaC,KAAKA,EAA5B,CAAX;;;WAGKR,GAAGC,CAAH,EAAMG,CAAN,EAASE,QAAT,CAAP;GAbF;;KAgBG,YAAH,EAAiB,UAACZ,CAAD,EAAO;YACdA,EAAEQ,OAAF,CAAUS,MAAV,GAAmB,CAA3B;YACQZ,YAAYL,CAAZ,EAAeF,OAAf,CAAR;GAFF;;KAKG,WAAH,EAAgB,UAACE,CAAD,EAAO;;;MAGnBkB,cAAF;;YAEQb,YAAYL,CAAZ,EAAeH,KAAf,CAAR;GALF;;KAQG,UAAH,EAAe,YAAM;YACX,CAAC,CAAT;GADF;;KAIG,OAAH,EAAY,UAACG,CAAD,EAAO;MACfkB,cAAF;MACEC,eAAF;;YAEQ,CAAR;YACQ,CAAC,CAAD,EAAI,CAAJ,EAAOnB,EAAEoB,MAAT,CAAR;GALF;;SAQO,YAAM;QACLb,IAAIX,MAAM,CAAN,CAAV;QACMc,IAAId,MAAM,CAAN,CAAV;QACMyB,IAAIzB,MAAM,CAAN,CAAV;;;YAGQ,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAR;;WAEO,EAAEW,IAAF,EAAKG,IAAL,EAAQW,IAAR,EAAW1B,YAAX,EAAP;GARF;CArEiB,EAAnB,CAiFA;;;;"}