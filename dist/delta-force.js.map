{"version":3,"file":"delta-force.js","sources":["../index.es"],"sourcesContent":["import bipolar from 'bipolar';\n\nconst deltaForce = (() => {\n  // -1: idle, 0: left, 1: middle, 2: right\n  let state = -1;\n  let delta = [0, 0, 0];\n  let force = bipolar();\n\n  const on = document.addEventListener;\n  const off = document.removeEventListener;\n\n  const handleTouch = (e, fn) => {\n    const x = e.touches[0].pageX;\n    const y = e.touches[0].pageY;\n\n    let dsq = 0;\n\n    if (state === 1) {\n      const dx = x - e.touches[1].pageX;\n      const dy = y - e.touches[1].pageY;\n\n      dsq = (dx * dx) + (dy * dy);\n    }\n\n    return fn(x, y, dsq);\n  };\n\n  const mouseMove = (e) => {\n    delta = force(e.clientX, e.clientY, 0);\n  };\n\n  const mouseUp = () => {\n    state = -1;\n\n    off('mouseup', mouseUp);\n    off('mousemove', mouseMove);\n  };\n\n  on('mousedown', (e) => {\n    state = e.button;\n    force = bipolar(e.clientX, e.clientY, 0);\n\n    on('mouseup', mouseUp);\n    on('mousemove', mouseMove);\n  });\n\n  on('touchstart', (e) => {\n    state = e.touches.length - 1;\n    force = handleTouch(e, bipolar);\n  });\n\n  on('touchmove', (e) => {\n    // Can't rely on viewport meta tag no more\n    // https://twitter.com/thomasfuchs/status/742531231007559680\n    e.preventDefault();\n\n    delta = handleTouch(e, force);\n  });\n\n  on('touchend', () => {\n    state = -1;\n  });\n\n  on('wheel', (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    state = 1;\n    delta = [0, 0, e.deltaY];\n  });\n\n  return () => {\n    const x = delta[0];\n    const y = delta[1];\n    const z = delta[2];\n\n    // Reset\n    delta = [0, 0, 0];\n\n    return { x, y, z, state };\n  };\n})();\n\nexport default deltaForce;\n\n"],"names":["deltaForce","state","delta","force","bipolar","on","document","addEventListener","off","removeEventListener","handleTouch","e","fn","x","touches","pageX","y","pageY","dsq","dx","dy","mouseMove","clientX","clientY","mouseUp","button","length","preventDefault","stopPropagation","deltaY","z"],"mappings":";;;AAEA,IAAMA,aAAc,YAAM;;MAEpBC,QAAQ,CAAC,CAAb;MACIC,QAAQ,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAZ;MACIC,QAAQC,SAAZ;;MAEMC,KAAKC,SAASC,gBAApB;MACMC,MAAMF,SAASG,mBAArB;;MAEMC,cAAc,SAAdA,WAAc,CAACC,CAAD,EAAIC,EAAJ,EAAW;QACvBC,IAAIF,EAAEG,OAAF,CAAU,CAAV,EAAaC,KAAvB;QACMC,IAAIL,EAAEG,OAAF,CAAU,CAAV,EAAaG,KAAvB;;QAEIC,MAAM,CAAV;;QAEIjB,UAAU,CAAd,EAAiB;UACTkB,KAAKN,IAAIF,EAAEG,OAAF,CAAU,CAAV,EAAaC,KAA5B;UACMK,KAAKJ,IAAIL,EAAEG,OAAF,CAAU,CAAV,EAAaG,KAA5B;;YAEOE,KAAKA,EAAN,GAAaC,KAAKA,EAAxB;;;WAGKR,GAAGC,CAAH,EAAMG,CAAN,EAASE,GAAT,CAAP;GAbF;;MAgBMG,YAAY,SAAZA,SAAY,CAACV,CAAD,EAAO;YACfR,MAAMQ,EAAEW,OAAR,EAAiBX,EAAEY,OAAnB,EAA4B,CAA5B,CAAR;GADF;;MAIMC,UAAU,SAAVA,OAAU,GAAM;YACZ,CAAC,CAAT;;QAEI,SAAJ,EAAeA,OAAf;QACI,WAAJ,EAAiBH,SAAjB;GAJF;;KAOG,WAAH,EAAgB,UAACV,CAAD,EAAO;YACbA,EAAEc,MAAV;YACQrB,QAAQO,EAAEW,OAAV,EAAmBX,EAAEY,OAArB,EAA8B,CAA9B,CAAR;;OAEG,SAAH,EAAcC,OAAd;OACG,WAAH,EAAgBH,SAAhB;GALF;;KAQG,YAAH,EAAiB,UAACV,CAAD,EAAO;YACdA,EAAEG,OAAF,CAAUY,MAAV,GAAmB,CAA3B;YACQhB,YAAYC,CAAZ,EAAeP,OAAf,CAAR;GAFF;;KAKG,WAAH,EAAgB,UAACO,CAAD,EAAO;;;MAGnBgB,cAAF;;YAEQjB,YAAYC,CAAZ,EAAeR,KAAf,CAAR;GALF;;KAQG,UAAH,EAAe,YAAM;YACX,CAAC,CAAT;GADF;;KAIG,OAAH,EAAY,UAACQ,CAAD,EAAO;MACfgB,cAAF;MACEC,eAAF;;YAEQ,CAAR;YACQ,CAAC,CAAD,EAAI,CAAJ,EAAOjB,EAAEkB,MAAT,CAAR;GALF;;SAQO,YAAM;QACLhB,IAAIX,MAAM,CAAN,CAAV;QACMc,IAAId,MAAM,CAAN,CAAV;QACM4B,IAAI5B,MAAM,CAAN,CAAV;;;YAGQ,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAR;;WAEO,EAAEW,IAAF,EAAKG,IAAL,EAAQc,IAAR,EAAW7B,YAAX,EAAP;GARF;CArEiB,EAAnB,CAiFA;;;;"}