{"version":3,"file":"delta-force.js","sources":["../index.es"],"sourcesContent":["const v3 = [0, 0, 0];\nconst bipolar = (x, y, z) => {\n  let memo = [x, y, z];\n\n  return (x, y, z) => {\n    const next = [x, y, z];\n    const diff = memo.map((v, i) => next[i] - v);\n\n    memo = next;\n\n    return diff;\n  };\n};\n\n// -1: idle, 0: left, 1: middle, 2: right\nlet state = -1;\nlet delta = v3;\nlet force = v3;\n\nconst on = document.addEventListener;\nconst off = document.removeEventListener;\n\nconst mouseMove = (e) => {\n  delta = force(e.clientX, e.clientY, 0);\n};\n\nconst mouseUp = () => {\n  state = -1;\n\n  off('mouseup', mouseUp);\n  off('mousemove', mouseMove);\n};\n\non('mousedown', (e) => {\n  state = e.button;\n  force = bipolar(e.clientX, e.clientY, 0);\n\n  on('mouseup', mouseUp);\n  on('mousemove', mouseMove);\n});\n\nconst handleTouch = (e, fn) => {\n  const x = e.touches[0].pageX;\n  const y = e.touches[0].pageY;\n\n  let dsq = 0;\n\n  if (state === 1) {\n    const dx = x - e.touches[1].pageX;\n    const dy = y - e.touches[1].pageY;\n\n    dsq = (dx * dx) + (dy * dy);\n  }\n\n  return fn(x, y, dsq);\n};\n\non('touchstart', (e) => {\n  state = e.touches.length - 1;\n  force = handleTouch(e, bipolar);\n});\n\non('touchmove', (e) => {\n  // Can't rely on viewport meta tag no more\n  // https://twitter.com/thomasfuchs/status/742531231007559680\n  e.preventDefault();\n\n  delta = handleTouch(e, force);\n});\n\non('touchend', () => {\n  state = -1;\n});\n\non('wheel', (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n\n  state = 1;\n  delta = [0, 0, e.deltaY];\n});\n\nconst deltaForce = () => {\n  const x = delta[0];\n  const y = delta[1];\n  const z = delta[2];\n\n  delta = v3;\n\n  return { x, y, z, code: state };\n};\n\nexport default deltaForce;\n\n"],"names":["v3","bipolar","x","y","z","memo","next","diff","map","v","i","state","delta","force","on","document","addEventListener","off","removeEventListener","mouseMove","e","clientX","clientY","mouseUp","button","handleTouch","fn","touches","pageX","pageY","dsq","dx","dy","length","preventDefault","stopPropagation","deltaY","deltaForce","code"],"mappings":";;;AAAA,IAAMA,KAAK,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAX;AACA,IAAMC,UAAU,SAAVA,OAAU,CAACC,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAa;MACvBC,OAAO,CAACH,CAAD,EAAIC,CAAJ,EAAOC,CAAP,CAAX;;SAEO,UAACF,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAa;QACZE,OAAO,CAACJ,CAAD,EAAIC,CAAJ,EAAOC,CAAP,CAAb;QACMG,OAAOF,KAAKG,GAAL,CAAS,UAACC,CAAD,EAAIC,CAAJ;aAAUJ,KAAKI,CAAL,IAAUD,CAApB;KAAT,CAAb;;WAEOH,IAAP;;WAEOC,IAAP;GANF;CAHF;;;AAcA,IAAII,QAAQ,CAAC,CAAb;AACA,IAAIC,QAAQZ,EAAZ;AACA,IAAIa,QAAQb,EAAZ;;AAEA,IAAMc,KAAKC,SAASC,gBAApB;AACA,IAAMC,MAAMF,SAASG,mBAArB;;AAEA,IAAMC,YAAY,SAAZA,SAAY,CAACC,CAAD,EAAO;UACfP,MAAMO,EAAEC,OAAR,EAAiBD,EAAEE,OAAnB,EAA4B,CAA5B,CAAR;CADF;;AAIA,IAAMC,UAAU,SAAVA,OAAU,GAAM;UACZ,CAAC,CAAT;;MAEI,SAAJ,EAAeA,OAAf;MACI,WAAJ,EAAiBJ,SAAjB;CAJF;;AAOAL,GAAG,WAAH,EAAgB,UAACM,CAAD,EAAO;UACbA,EAAEI,MAAV;UACQvB,QAAQmB,EAAEC,OAAV,EAAmBD,EAAEE,OAArB,EAA8B,CAA9B,CAAR;;KAEG,SAAH,EAAcC,OAAd;KACG,WAAH,EAAgBJ,SAAhB;CALF;;AAQA,IAAMM,cAAc,SAAdA,WAAc,CAACL,CAAD,EAAIM,EAAJ,EAAW;MACvBxB,IAAIkB,EAAEO,OAAF,CAAU,CAAV,EAAaC,KAAvB;MACMzB,IAAIiB,EAAEO,OAAF,CAAU,CAAV,EAAaE,KAAvB;;MAEIC,MAAM,CAAV;;MAEInB,UAAU,CAAd,EAAiB;QACToB,KAAK7B,IAAIkB,EAAEO,OAAF,CAAU,CAAV,EAAaC,KAA5B;QACMI,KAAK7B,IAAIiB,EAAEO,OAAF,CAAU,CAAV,EAAaE,KAA5B;;UAEOE,KAAKA,EAAN,GAAaC,KAAKA,EAAxB;;;SAGKN,GAAGxB,CAAH,EAAMC,CAAN,EAAS2B,GAAT,CAAP;CAbF;;AAgBAhB,GAAG,YAAH,EAAiB,UAACM,CAAD,EAAO;UACdA,EAAEO,OAAF,CAAUM,MAAV,GAAmB,CAA3B;UACQR,YAAYL,CAAZ,EAAenB,OAAf,CAAR;CAFF;;AAKAa,GAAG,WAAH,EAAgB,UAACM,CAAD,EAAO;;;IAGnBc,cAAF;;UAEQT,YAAYL,CAAZ,EAAeP,KAAf,CAAR;CALF;;AAQAC,GAAG,UAAH,EAAe,YAAM;UACX,CAAC,CAAT;CADF;;AAIAA,GAAG,OAAH,EAAY,UAACM,CAAD,EAAO;IACfc,cAAF;IACEC,eAAF;;UAEQ,CAAR;UACQ,CAAC,CAAD,EAAI,CAAJ,EAAOf,EAAEgB,MAAT,CAAR;CALF;;AAQA,IAAMC,aAAa,SAAbA,UAAa,GAAM;MACjBnC,IAAIU,MAAM,CAAN,CAAV;MACMT,IAAIS,MAAM,CAAN,CAAV;MACMR,IAAIQ,MAAM,CAAN,CAAV;;UAEQZ,EAAR;;SAEO,EAAEE,IAAF,EAAKC,IAAL,EAAQC,IAAR,EAAWkC,MAAM3B,KAAjB,EAAP;CAPF,CAUA;;;;"}